<!DOCTYPE html>
	<html>
		<head>
			<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
			<title>Formulaire de commande</title>
			<link rel="stylesheet" type="text/css" href="styles/style.css"/>
		</head>
		<body>
			<form>
			<div id="client">
				<table>
					<tr>
						<th colspan=2 >Facture achat ordinateur portable</th>
					</tr>
					<tr>
						<td><label for="nom">Nom complet</label> </td>
						<td><input type="text" id="nom" name="nom" placeholder="ex:Bob Tremblay"> </td>
					</tr>
					<tr>
						<td><label for="code">Code postal</label> </td>
						<td><input type="text" id="code" name="code" size="10" placeholder="ex:H0H 0H0" > </td>
					</tr>
					<tr>
						<td><label for="courriel1">Courriel</label> </td>
						<td><input type="text" id="courriel1" name="courriel1"> </td>
					</tr>
					<tr>
						<td><label for="courriel2">Confirmez courriel</label> </td>
						<td><input type="text" id="courriel2" name="courriel2"> </td>
					</tr>
				
				</table>
				<p id="alert_courriel" style="color:red;">Les adresses courriels doivent être identiques</p>
				<p id="alert_champ" style="color:red;">Tous les champs doivent être remplis</p>
				
				<hr>
			</div>
			<div id="modele">	
				<p>
					<label for="modele">Quelle marque voulez-vous ?</label>
					<br />
					<select name="modele" id="modele">
					  <option value="dell 799.99">Dell - 799,99$</option>
					  <option value="asus 899.99">Asus - 899,99$</option>
					  <option value="ibm 999.99">IBM Thinkpad - 999,99$</option>
					  <option value="macbook 1099.99">MacBook - 1099,99$</option>
					</select>
					<br />
					Cochez les options que vous voulez ajouter :<br />
				   <input type="checkbox" name="ecran 300" id="ecran" /> <label for="ecran">Écran - 300$</label><br />
				   <input type="checkbox" name="garanti 200" id="garanti" /> <label for="garanti">Garantie 2 ans - 200$</label><br />
				   <input type="checkbox" name="imprimante 100" id="imprimante" /> <label for="imprimante">Imprimante - 100$</label><br />
				   <input type="checkbox" name="souris 40" id="souris" /> <label for="souris">Souris sans fil - 40$</label>
				   <br />
				</p>
				<hr>
			</div>
			<div id="boutons">	
				<input type="submit" value="Commander" />  ou 
				<input type="reset" value="Recommencer" /> 
			</form>
			<hr>
			</div>
			<div id="facture">
			<h1>Facture</h1>
			<p id="en_attente">En attente de l'envoi du formulaire</p>
			<p>
				<table id="la_facture">
					<th>Facture achat ordinateur portable</th>
					<tr>
						<td id="msg" colspan=3 > </td>
					</tr>
					<tr id="machine">
						<td >Machine</td>
					</tr>
					<tr>
						<td colspan=3 >Options</td>
					</tr>
				</table>
			</p>
			</div>
		<script src="scripts/jquery-3.5.1.min.js"></script>	
		<script>
		
			$(function() {
			
				console.log($(this).val());
				
				$("#la_facture").hide();
				$("#alert_courriel").hide(); 
				$("#alert_champ").hide();
				
				$('input[type=text]').click(function() {
									$(this).css("background-color","#d9873f");
										$(this).focusout(function() {
											$(this).css("background-color","");
										});		
									});
				
				$("#ecran").change(function() {
										if($(this).prop( "checked" )) {
											alert("Merci de choisir un écran !");
										} else {
											alert("Êtes-vous sur que vous ne voulez pas un écran ?");
										}
									});
				
				function verifications(){
					if ($('#courriel2').val() != $('#courriel1').val()){
						$("#alert_courriel").show();
						return false;
					}
					if (!$('#nom').val() ||
						!$('#code').val() ||
						!$('#courriel1').val() ||
						!$('#courriel2').val()   ){
						$("#alert_champ").show();
						return false;
					} 
					return true;
					
				}
				
				
				$('form').submit(function(e) {
								e.preventDefault();
								if (verifications()){
									$("#alert_courriel").hide(); 
									$("#alert_champ").hide();
									afficherFacture();
									alert("Votre commande a bien été envoyée.");
								}
								
		
				});
				
				function afficherFacture(){
					var total = 0;
					$("#en_attente").html("Voici votre facture.");
					
					
					var tableau_facture = $('form').serializeArray();
					
					//afficher message
					$('#msg').html("Merci de faire affaire avec nous "+ tableau_facture[0].value + ".</br>"+
									"Votre facture sera envoyée à "+ tableau_facture[1].value + ".</br>"+
									"Et un courriel de confirmation à "+tableau_facture[3].value);
					
					//afficher machine et prix
					var info_machine = tableau_facture[4].value.split(" ", 2);
					
					$('#machine').append("<td>"+info_machine[0]+"</td>");
					$('#machine').append("<td>"+info_machine[1]+"</td>");
					total += parseFloat(info_machine[1]);
					
					//afficher options et prix
					var nbr_options = 1;
					for (var v = 5; v < tableau_facture.length; v++){
						var info_option = tableau_facture[v].name.split(" ", 2);
						$("#la_facture tr:last").after('<tr><td>'
												+nbr_options+'</td><td>'
												+info_option[0]+'</td><td>'
												+info_option[1]+'</td></tr>');
												nbr_options++;
												total += parseFloat(info_option[1]);
						
					}
					
					//afficher total et devoiler
					$("#la_facture tr:last").after('<tr><td>Total</td><td>'
												+total+'</td></tr>');
					if (total  > 1000){
					 $("#la_facture").addClass("plus");
					}else{
					 $("#la_facture").addClass("moins");
					}
					
					$("#la_facture").show();
					$(":submit").prop('disabled', true);
					
				}
	
			});	
		
		</script>
		
	</body>
</html>